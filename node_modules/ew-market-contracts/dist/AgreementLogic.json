{"abi":[{"constant":false,"inputs":[{"name":"_propertiesDocumentHash","type":"string"},{"name":"_documentDBURL","type":"string"},{"name":"_matcherPropertiesDocumentHash","type":"string"},{"name":"_matcherDBURL","type":"string"},{"name":"_demandId","type":"uint256"},{"name":"_supplyId","type":"uint256"}],"name":"createAgreement","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_agreementId","type":"uint256"}],"name":"approveAgreementSupply","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_newLogic","type":"address"}],"name":"update","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_agreementId","type":"uint256"}],"name":"approveAgreementDemand","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"getAllAgreementListLength","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"userContractLookup","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"db","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"_agreementId","type":"uint256"}],"name":"getAgreement","outputs":[{"name":"_propertiesDocumentHash","type":"string"},{"name":"_documentDBURL","type":"string"},{"name":"_matcherPropertiesDocumentHash","type":"string"},{"name":"_matcherDBURL","type":"string"},{"name":"_demandId","type":"uint256"},{"name":"_supplyId","type":"uint256"},{"name":"_approvedBySupplyOwner","type":"bool"},{"name":"_approvedByDemandOwner","type":"bool"},{"name":"_allowedMatcher","type":"address[]"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_agreementId","type":"uint256"},{"name":"_matcherPropertiesDocumentHash","type":"string"},{"name":"_matcherDBURL","type":"string"}],"name":"setMatcherProperties","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"assetContractLookup","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"owner","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_newOwner","type":"address"}],"name":"changeOwner","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"_role","type":"uint8"},{"name":"_caller","type":"address"}],"name":"isRole","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"_agreementId","type":"uint256"}],"name":"getAgreementStruct","outputs":[{"components":[{"name":"propertiesDocumentHash","type":"string"},{"name":"documentDBURL","type":"string"},{"name":"matcherPropertiesDocumentHash","type":"string"},{"name":"matcherDBURL","type":"string"},{"name":"demandId","type":"uint256"},{"name":"supplyId","type":"uint256"},{"name":"approvedBySupplyOwner","type":"bool"},{"name":"approvedByDemandOwner","type":"bool"},{"name":"allowedMatcher","type":"address[]"}],"name":"","type":"tuple"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_database","type":"address"},{"name":"_admin","type":"address"}],"name":"init","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"inputs":[{"name":"_assetContractLookup","type":"address"},{"name":"_marketContractLookup","type":"address"}],"payable":false,"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":true,"name":"_agreementId","type":"uint256"},{"indexed":true,"name":"_demandId","type":"uint256"},{"indexed":true,"name":"_supplyId","type":"uint256"}],"name":"LogAgreementFullySigned","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"name":"_agreementId","type":"uint256"},{"indexed":true,"name":"_demandId","type":"uint256"},{"indexed":true,"name":"_supplyId","type":"uint256"}],"name":"LogAgreementCreated","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"_newOwner","type":"address"}],"name":"LogChangeOwner","type":"event"}],"bytecode":"60806040523480156200001157600080fd5b50604051604080620029aa833981018060405262000033919081019062000156565b81600160a060020a0316635c7460d66040518163ffffffff167c010000000000000000000000000000000000000000000000000000000002815260040160206040518083038186803b1580156200008957600080fd5b505afa1580156200009e573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250620000c491908101906200012d565b60008054600160a060020a03938416600160a060020a031991821617909155600180549284169282169290921790915560038054939092169216919091179055620001c1565b600062000118825162000195565b9392505050565b6000620001188251620001a8565b6000602082840312156200014057600080fd5b60006200014e84846200010a565b949350505050565b600080604083850312156200016a57600080fd5b60006200017885856200011f565b92505060206200018b858286016200011f565b9150509250929050565b6000620001a282620001b5565b92915050565b6000620001a28262000195565b600160a060020a031690565b6127d980620001d16000396000f3fe608060405234801561001057600080fd5b50600436106100f95760003560e060020a900480634f9f6fe61161009b578063a6f9dae11161006a578063a6f9dae1146101df578063bb5a389e146101f2578063da119ed114610212578063f09a401614610232576100f9565b80634f9f6fe61461018757806361d16d2d146101af5780636c608004146101c25780638da5cb5b146101ca576100f9565b80632201914b116100d75780632201914b1461013957806323dc20731461014c57806344724c8c1461016a5780634d655aff1461017f576100f9565b8063075d79f4146100fe57806317f2a632146101135780631c1b877214610126575b600080fd5b61011161010c366004611d60565b610245565b005b610111610121366004611ee6565b610632565b610111610134366004611b6c565b6109a1565b610111610147366004611ee6565b610a51565b610154610ca7565b604051610161919061260a565b60405180910390f35b610172610d42565b6040516101619190612448565b610172610d51565b61019a610195366004611ee6565b610d60565b604051610161999897969594939291906124d2565b6101116101bd366004611f22565b610e63565b610172611062565b6101d2611071565b604051610161919061242c565b6101116101ed366004611b6c565b611080565b610205610200366004611d41565b611145565b604051610161919061243a565b610225610220366004611ee6565b611272565b60405161016191906125f9565b610111610240366004611bb0565b611317565b61024d6116ab565b6002546040517f1ac2733c000000000000000000000000000000000000000000000000000000008152600160a060020a0390911690631ac2733c9061029690869060040161260a565b60006040518083038186803b1580156102ae57600080fd5b505afa1580156102c2573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f191682016040526102ea9190810190611e7c565b90506102f46116ca565b6002546040517ff77ee79d000000000000000000000000000000000000000000000000000000008152600160a060020a039091169063f77ee79d9061033d90869060040161260a565b60006040518083038186803b15801561035557600080fd5b505afa158015610369573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f191682016040526103919190810190611eb1565b90506000600360009054906101000a9004600160a060020a0316600160a060020a03166324a793c46040518163ffffffff1660e060020a02815260040160206040518083038186803b1580156103e657600080fd5b505afa1580156103fa573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525061041e9190810190611b92565b600160a060020a0316638d5802e283604001516040518263ffffffff1660e060020a028152600401610450919061260a565b60206040518083038186803b15801561046857600080fd5b505afa15801561047c573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052506104a09190810190611b92565b90508260400151600160a060020a031633600160a060020a031614806104ce575033600160a060020a038216145b15156104fd5760405160008051602061278083398151915281526004016104f490612589565b60405180910390fd5b6000600260009054906101000a9004600160a060020a0316600160a060020a031663f1366d428f8f8f8f8f8f8f8f8f8f6040518b63ffffffff1660e060020a0281526004016105559a99989796959493929190612456565b602060405180830381600087803b15801561056f57600080fd5b505af1158015610583573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052506105a79190810190611f04565b90506105b2816113aa565b8360400151600160a060020a031633600160a060020a031614156105d9576105d981610a51565b33600160a060020a03831614156105f3576105f381610632565b8486827f61ed177e1ad571ab2a6cca1c272c10474c022ed031809251ef65516f8c7d600860405160405180910390a45050505050505050505050505050565b61063a6116ec565b6002546040517f51ec4656000000000000000000000000000000000000000000000000000000008152600160a060020a03909116906351ec46569061068390859060040161260a565b60006040518083038186803b15801561069b57600080fd5b505afa1580156106af573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f191682016040526106d79190810190611e47565b90506106e16116ca565b60025460a08301516040517ff77ee79d000000000000000000000000000000000000000000000000000000008152600160a060020a039092169163f77ee79d9161072d9160040161260a565b60006040518083038186803b15801561074557600080fd5b505afa158015610759573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f191682016040526107819190810190611eb1565b905033600160a060020a0316600360009054906101000a9004600160a060020a0316600160a060020a03166324a793c46040518163ffffffff1660e060020a02815260040160206040518083038186803b1580156107de57600080fd5b505afa1580156107f2573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052506108169190810190611b92565b600160a060020a0316638d5802e283604001516040518263ffffffff1660e060020a028152600401610848919061260a565b60206040518083038186803b15801561086057600080fd5b505afa158015610874573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052506108989190810190611b92565b600160a060020a0316146108c65760405160008051602061278083398151915281526004016104f4906125e9565b6002546040517f83cc57c5000000000000000000000000000000000000000000000000000000008152600160a060020a03909116906383cc57c59061090f90869060040161260a565b602060405180830381600087803b15801561092957600080fd5b505af115801561093d573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052506109619190810190611d23565b1561099c5760a0820151608083015160405185907fe6aa55a5f0d0d79d1f57832e265b9f8f8e44714636f732a4a7abc134a2fd360e90600090a45b505050565b600054600160a060020a031633146109d35760405160008051602061278083398151915281526004016104f4906125b9565b6002546040517fa6f9dae1000000000000000000000000000000000000000000000000000000008152600160a060020a039091169063a6f9dae190610a1c90849060040161242c565b600060405180830381600087803b158015610a3657600080fd5b505af1158015610a4a573d6000803e3d6000fd5b5050505050565b610a596116ec565b6002546040517f51ec4656000000000000000000000000000000000000000000000000000000008152600160a060020a03909116906351ec465690610aa290859060040161260a565b60006040518083038186803b158015610aba57600080fd5b505afa158015610ace573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f19168201604052610af69190810190611e47565b60025460808201516040517f1ac2733c0000000000000000000000000000000000000000000000000000000081529293503392600160a060020a0390921691631ac2733c91610b479160040161260a565b60006040518083038186803b158015610b5f57600080fd5b505afa158015610b73573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f19168201604052610b9b9190810190611e7c565b60400151600160a060020a031614610bcd5760405160008051602061278083398151915281526004016104f490612599565b6002546040517fb5d006f3000000000000000000000000000000000000000000000000000000008152600160a060020a039091169063b5d006f390610c1690859060040161260a565b602060405180830381600087803b158015610c3057600080fd5b505af1158015610c44573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250610c689190810190611d23565b15610ca35760a0810151608082015160405184907fe6aa55a5f0d0d79d1f57832e265b9f8f8e44714636f732a4a7abc134a2fd360e90600090a45b5050565b600254604080517f03cb53ec0000000000000000000000000000000000000000000000000000000081529051600092600160a060020a0316916303cb53ec916004808301926020929190829003018186803b158015610d0557600080fd5b505afa158015610d19573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250610d3d9190810190611f04565b905090565b600154600160a060020a031681565b600254600160a060020a031681565b6060806060806000806000806060610d766116ec565b6002546040517f51ec4656000000000000000000000000000000000000000000000000000000008152600160a060020a03909116906351ec465690610dbf908e9060040161260a565b60006040518083038186803b158015610dd757600080fd5b505afa158015610deb573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f19168201604052610e139190810190611e47565b905080600001519950806020015198508060400151975080606001519650806080015195508060a0015194508060c0015193508060e0015192508061010001519150509193959799909294969850565b610e6b6116ec565b6002546040517f51ec4656000000000000000000000000000000000000000000000000000000008152600160a060020a03909116906351ec465690610eb490899060040161260a565b60006040518083038186803b158015610ecc57600080fd5b505afa158015610ee0573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f19168201604052610f089190810190611e47565b90508060c001511515610f355760405160008051602061278083398151915281526004016104f4906125c9565b8060e001511515610f605760405160008051602061278083398151915281526004016104f490612569565b6101008101516000805b8251811015610fad5782513390849083908110610f8357fe5b90602001906020020151600160a060020a03161415610fa55760019150610fad565b600101610f6a565b50801515610fd55760405160008051602061278083398151915281526004016104f4906125a9565b6002546040517f1ebb242f000000000000000000000000000000000000000000000000000000008152600160a060020a0390911690631ebb242f90611026908b908b908b908b908b90600401612638565b600060405180830381600087803b15801561104057600080fd5b505af1158015611054573d6000803e3d6000fd5b505050505050505050505050565b600354600160a060020a031681565b600054600160a060020a031681565b600054600160a060020a031633146110b25760405160008051602061278083398151915281526004016104f4906125b9565b600160a060020a03811615156110e25760405160008051602061278083398151915281526004016104f490612579565b6000805473ffffffffffffffffffffffffffffffffffffffff1916600160a060020a0383161790556040517f95fd54179c11867fb083dd94347ea50f144dd4cfd7612b7bca169f162824af169061113a90839061242c565b60405180910390a150565b600080600160009054906101000a9004600160a060020a0316600160a060020a0316635c7460d66040518163ffffffff1660e060020a02815260040160206040518083038186803b15801561119957600080fd5b505afa1580156111ad573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052506111d19190810190611b92565b600160a060020a031663265209f2846040518263ffffffff1660e060020a0281526004016111ff919061242c565b60206040518083038186803b15801561121757600080fd5b505afa15801561122b573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525061124f9190810190611f04565b9050600084600581111561125f57fe5b60020a9190911615159150505b92915050565b61127a6116ec565b6002546040517f51ec4656000000000000000000000000000000000000000000000000000000008152600160a060020a03909116906351ec4656906112c390859060040161260a565b60006040518083038186803b1580156112db57600080fd5b505afa1580156112ef573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f1916820160405261126c9190810190611e47565b600054600160a060020a031633146113495760405160008051602061278083398151915281526004016104f4906125b9565b600254600160a060020a03161561137a5760405160008051602061278083398151915281526004016104f4906125d9565b506002805473ffffffffffffffffffffffffffffffffffffffff1916600160a060020a0392909216919091179055565b6113b26116ec565b6002546040517f51ec4656000000000000000000000000000000000000000000000000000000008152600160a060020a03909116906351ec4656906113fb90859060040161260a565b60006040518083038186803b15801561141357600080fd5b505afa158015611427573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f1916820160405261144f9190810190611e47565b610100810151519091501561146057fe5b6114686116ca565b60025460a08301516040517ff77ee79d000000000000000000000000000000000000000000000000000000008152600160a060020a039092169163f77ee79d916114b49160040161260a565b60006040518083038186803b1580156114cc57600080fd5b505afa1580156114e0573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f191682016040526115089190810190611eb1565b90506060600360009054906101000a9004600160a060020a0316600160a060020a03166324a793c46040518163ffffffff1660e060020a02815260040160206040518083038186803b15801561155d57600080fd5b505afa158015611571573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052506115959190810190611b92565b600160a060020a031663ade1e99283604001516040518263ffffffff1660e060020a0281526004016115c7919061260a565b60006040518083038186803b1580156115df57600080fd5b505afa1580156115f3573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f1916820160405261161b9190810190611bea565b50506002546040517f43f3f19a000000000000000000000000000000000000000000000000000000008152939950600160a060020a031697506343f3f19a965061167395508b94508893505060049091019050612618565b600060405180830381600087803b15801561168d57600080fd5b505af11580156116a1573d6000803e3d6000fd5b5050505050505050565b6040805160608181018352808252602082015260009181019190915290565b6060604051908101604052806060815260200160608152602001600081525090565b61012060405190810160405280606081526020016060815260200160608152602001606081526020016000815260200160008152602001600015158152602001600015158152602001606081525090565b600061174982356126fc565b9392505050565b600061174982516126fc565b6000601f8201831361176d57600080fd5b815161178061177b826126a0565b612679565b915081818352602084019350602081019050838560208402820111156117a557600080fd5b60005b838110156117d157816117bb8882611750565b84525060209283019291909101906001016117a8565b5050505092915050565b6000601f820183136117ec57600080fd5b81516117fa61177b826126a0565b9150818183526020840193506020810190508385602084028201111561181f57600080fd5b60005b838110156117d157816118358882611750565b8452506020928301929190910190600101611822565b60006117498251612707565b6000611749823561271b565b600080601f8301841361187557600080fd5b50813567ffffffffffffffff81111561188d57600080fd5b6020830191508360018202830111156118a557600080fd5b9250929050565b6000601f820183136118bd57600080fd5b81516118cb61177b826126c1565b915080825260208301602083018583830111156118e757600080fd5b6118f2838284612745565b50505092915050565b6000610120828403121561190e57600080fd5b611919610120612679565b825190915067ffffffffffffffff81111561193357600080fd5b61193f848285016118ac565b825250602082015167ffffffffffffffff81111561195c57600080fd5b611968848285016118ac565b602083015250604082015167ffffffffffffffff81111561198857600080fd5b611994848285016118ac565b604083015250606082015167ffffffffffffffff8111156119b457600080fd5b6119c0848285016118ac565b60608301525060806119d484828501611b60565b60808301525060a06119e884828501611b60565b60a08301525060c06119fc8482850161184b565b60c08301525060e0611a108482850161184b565b60e08301525061010082015167ffffffffffffffff811115611a3157600080fd5b611a3d8482850161175c565b6101008301525092915050565b600060608284031215611a5c57600080fd5b611a666060612679565b825190915067ffffffffffffffff811115611a8057600080fd5b611a8c848285016118ac565b825250602082015167ffffffffffffffff811115611aa957600080fd5b611ab5848285016118ac565b6020830152506040611ac984828501611750565b60408301525092915050565b600060608284031215611ae757600080fd5b611af16060612679565b825190915067ffffffffffffffff811115611b0b57600080fd5b611b17848285016118ac565b825250602082015167ffffffffffffffff811115611b3457600080fd5b611b40848285016118ac565b6020830152506040611ac984828501611b60565b60006117498235612718565b60006117498251612718565b600060208284031215611b7e57600080fd5b6000611b8a848461173d565b949350505050565b600060208284031215611ba457600080fd5b6000611b8a8484611750565b60008060408385031215611bc357600080fd5b6000611bcf858561173d565b9250506020611be08582860161173d565b9150509250929050565b6000806000806000806000806000806101408b8d031215611c0a57600080fd5b6000611c168d8d611750565b9a50506020611c278d828e01611750565b9950506040611c388d828e01611b60565b9850506060611c498d828e0161184b565b97505060808b015167ffffffffffffffff811115611c6657600080fd5b611c728d828e016118ac565b96505060a08b015167ffffffffffffffff811115611c8f57600080fd5b611c9b8d828e016117db565b95505060c08b015167ffffffffffffffff811115611cb857600080fd5b611cc48d828e016118ac565b94505060e08b015167ffffffffffffffff811115611ce157600080fd5b611ced8d828e016118ac565b935050610100611cff8d828e01611750565b925050610120611d118d828e0161184b565b9150509295989b9194979a5092959850565b600060208284031215611d3557600080fd5b6000611b8a848461184b565b60008060408385031215611d5457600080fd5b6000611bcf8585611857565b60008060008060008060008060008060c08b8d031215611d7f57600080fd5b8a3567ffffffffffffffff811115611d9657600080fd5b611da28d828e01611863565b9a509a505060208b013567ffffffffffffffff811115611dc157600080fd5b611dcd8d828e01611863565b985098505060408b013567ffffffffffffffff811115611dec57600080fd5b611df88d828e01611863565b965096505060608b013567ffffffffffffffff811115611e1757600080fd5b611e238d828e01611863565b94509450506080611e368d828e01611b54565b92505060a0611d118d828e01611b54565b600060208284031215611e5957600080fd5b815167ffffffffffffffff811115611e7057600080fd5b611b8a848285016118fb565b600060208284031215611e8e57600080fd5b815167ffffffffffffffff811115611ea557600080fd5b611b8a84828501611a4a565b600060208284031215611ec357600080fd5b815167ffffffffffffffff811115611eda57600080fd5b611b8a84828501611ad5565b600060208284031215611ef857600080fd5b6000611b8a8484611b54565b600060208284031215611f1657600080fd5b6000611b8a8484611b60565b600080600080600060608688031215611f3a57600080fd5b6000611f468888611b54565b955050602086013567ffffffffffffffff811115611f6357600080fd5b611f6f88828901611863565b9450945050604086013567ffffffffffffffff811115611f8e57600080fd5b611f9a88828901611863565b92509250509295509295909350565b6000611fb58383611fbd565b505060200190565b611fc6816126fc565b82525050565b6000611fd7826126ef565b611fe181856126f3565b9350611fec836126e9565b60005b8281101561201757612002868351611fa9565b955061200d826126e9565b9150600101611fef565b5093949350505050565b600061202c826126ef565b61203681856126f3565b9350612041836126e9565b60005b8281101561201757612057868351611fa9565b9550612062826126e9565b9150600101612044565b611fc681612707565b611fc68161272e565b600061208a83856126f3565b9350612097838584612739565b6120a083612775565b9093019392505050565b60006120b5826126ef565b6120bf81856126f3565b93506120cf818560208601612745565b6120a081612775565b60006120e5601f836126f3565b7f64656d616e64206f776e657220686173206e6f74206167726565642079657400815260200192915050565b600061211e6018836126f3565b7f307830206173206f776e6572206e6f7420616c6c6f7765640000000000000000815260200192915050565b60006121576027836126f3565b7f63726561746544656d616e643a2077726f6e67206f776e6572207768656e206381527f72656174696e6700000000000000000000000000000000000000000000000000602082015260400192915050565b60006121b66028836126f3565b7f617070726f766541677265656d656e7444656d616e643a2077726f6e67206d7381527f672e73656e646572000000000000000000000000000000000000000000000000602082015260400192915050565b6000612215601e836126f3565b7f73656e646572206973206e6f7420696e206d6174636865722061727261790000815260200192915050565b600061224e6017836126f3565b7f6d73672e73656e646572206973206e6f74206f776e6572000000000000000000815260200192915050565b6000612287601f836126f3565b7f737570706c79206f776e657220686173206e6f74206167726565642079657400815260200192915050565b60006122c06018836126f3565b7f696e69743a20616c726561647920696e697469616c697a650000000000000000815260200192915050565b60006122f96028836126f3565b7f617070726f766541677265656d656e74537570706c793a2077726f6e67206d7381527f672e73656e646572000000000000000000000000000000000000000000000000602082015260400192915050565b80516101208084526000919084019061236482826120aa565b9150506020830151848203602086015261237e82826120aa565b9150506040830151848203604086015261239882826120aa565b915050606083015184820360608601526123b282826120aa565b91505060808301516123c76080860182612423565b5060a08301516123da60a0860182612423565b5060c08301516123ed60c086018261206c565b5060e083015161240060e086018261206c565b5061010083015184820361010086015261241a8282612021565b95945050505050565b611fc681612718565b6020810161126c8284611fbd565b6020810161126c828461206c565b6020810161126c8284612075565b60c08082528101612468818c8e61207e565b9050818103602083015261247d818a8c61207e565b9050818103604083015261249281888a61207e565b905081810360608301526124a781868861207e565b90506124b66080830185612423565b6124c360a0830184612423565b9b9a5050505050505050505050565b61012080825281016124e4818c6120aa565b905081810360208301526124f8818b6120aa565b9050818103604083015261250c818a6120aa565b9050818103606083015261252081896120aa565b905061252f6080830188612423565b61253c60a0830187612423565b61254960c083018661206c565b61255660e083018561206c565b8181036101008301526124c38184611fcc565b6020808252810161126c816120d8565b6020808252810161126c81612111565b6020808252810161126c8161214a565b6020808252810161126c816121a9565b6020808252810161126c81612208565b6020808252810161126c81612241565b6020808252810161126c8161227a565b6020808252810161126c816122b3565b6020808252810161126c816122ec565b60208082528101611749818461234b565b6020810161126c8284612423565b604081016126268285612423565b8181036020830152611b8a8184611fcc565b606081016126468288612423565b818103602083015261265981868861207e565b9050818103604083015261266e81848661207e565b979650505050505050565b60405181810167ffffffffffffffff8111828210171561269857600080fd5b604052919050565b600067ffffffffffffffff8211156126b757600080fd5b5060209081020190565b600067ffffffffffffffff8211156126d857600080fd5b506020601f91909101601f19160190565b60200190565b5190565b90815260200190565b600061126c8261270c565b151590565b600160a060020a031690565b90565b60006006821061272a57600080fd5b5090565b600061126c826126fc565b82818337506000910152565b60005b83811015612760578181015183820152602001612748565b8381111561276f576000848401525b50505050565b601f01601f19169056fe08c379a000000000000000000000000000000000000000000000000000000000a265627a7a723058209cfaa33af6e0586ae31a9d85299d9b2351783f9e77708aee8bd854083c4bee886c6578706572696d656e74616cf50037","contractName":"AgreementLogic","deployedBytecode":"608060405234801561001057600080fd5b50600436106100f95760003560e060020a900480634f9f6fe61161009b578063a6f9dae11161006a578063a6f9dae1146101df578063bb5a389e146101f2578063da119ed114610212578063f09a401614610232576100f9565b80634f9f6fe61461018757806361d16d2d146101af5780636c608004146101c25780638da5cb5b146101ca576100f9565b80632201914b116100d75780632201914b1461013957806323dc20731461014c57806344724c8c1461016a5780634d655aff1461017f576100f9565b8063075d79f4146100fe57806317f2a632146101135780631c1b877214610126575b600080fd5b61011161010c366004611d60565b610245565b005b610111610121366004611ee6565b610632565b610111610134366004611b6c565b6109a1565b610111610147366004611ee6565b610a51565b610154610ca7565b604051610161919061260a565b60405180910390f35b610172610d42565b6040516101619190612448565b610172610d51565b61019a610195366004611ee6565b610d60565b604051610161999897969594939291906124d2565b6101116101bd366004611f22565b610e63565b610172611062565b6101d2611071565b604051610161919061242c565b6101116101ed366004611b6c565b611080565b610205610200366004611d41565b611145565b604051610161919061243a565b610225610220366004611ee6565b611272565b60405161016191906125f9565b610111610240366004611bb0565b611317565b61024d6116ab565b6002546040517f1ac2733c000000000000000000000000000000000000000000000000000000008152600160a060020a0390911690631ac2733c9061029690869060040161260a565b60006040518083038186803b1580156102ae57600080fd5b505afa1580156102c2573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f191682016040526102ea9190810190611e7c565b90506102f46116ca565b6002546040517ff77ee79d000000000000000000000000000000000000000000000000000000008152600160a060020a039091169063f77ee79d9061033d90869060040161260a565b60006040518083038186803b15801561035557600080fd5b505afa158015610369573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f191682016040526103919190810190611eb1565b90506000600360009054906101000a9004600160a060020a0316600160a060020a03166324a793c46040518163ffffffff1660e060020a02815260040160206040518083038186803b1580156103e657600080fd5b505afa1580156103fa573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525061041e9190810190611b92565b600160a060020a0316638d5802e283604001516040518263ffffffff1660e060020a028152600401610450919061260a565b60206040518083038186803b15801561046857600080fd5b505afa15801561047c573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052506104a09190810190611b92565b90508260400151600160a060020a031633600160a060020a031614806104ce575033600160a060020a038216145b15156104fd5760405160008051602061278083398151915281526004016104f490612589565b60405180910390fd5b6000600260009054906101000a9004600160a060020a0316600160a060020a031663f1366d428f8f8f8f8f8f8f8f8f8f6040518b63ffffffff1660e060020a0281526004016105559a99989796959493929190612456565b602060405180830381600087803b15801561056f57600080fd5b505af1158015610583573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052506105a79190810190611f04565b90506105b2816113aa565b8360400151600160a060020a031633600160a060020a031614156105d9576105d981610a51565b33600160a060020a03831614156105f3576105f381610632565b8486827f61ed177e1ad571ab2a6cca1c272c10474c022ed031809251ef65516f8c7d600860405160405180910390a45050505050505050505050505050565b61063a6116ec565b6002546040517f51ec4656000000000000000000000000000000000000000000000000000000008152600160a060020a03909116906351ec46569061068390859060040161260a565b60006040518083038186803b15801561069b57600080fd5b505afa1580156106af573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f191682016040526106d79190810190611e47565b90506106e16116ca565b60025460a08301516040517ff77ee79d000000000000000000000000000000000000000000000000000000008152600160a060020a039092169163f77ee79d9161072d9160040161260a565b60006040518083038186803b15801561074557600080fd5b505afa158015610759573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f191682016040526107819190810190611eb1565b905033600160a060020a0316600360009054906101000a9004600160a060020a0316600160a060020a03166324a793c46040518163ffffffff1660e060020a02815260040160206040518083038186803b1580156107de57600080fd5b505afa1580156107f2573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052506108169190810190611b92565b600160a060020a0316638d5802e283604001516040518263ffffffff1660e060020a028152600401610848919061260a565b60206040518083038186803b15801561086057600080fd5b505afa158015610874573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052506108989190810190611b92565b600160a060020a0316146108c65760405160008051602061278083398151915281526004016104f4906125e9565b6002546040517f83cc57c5000000000000000000000000000000000000000000000000000000008152600160a060020a03909116906383cc57c59061090f90869060040161260a565b602060405180830381600087803b15801561092957600080fd5b505af115801561093d573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052506109619190810190611d23565b1561099c5760a0820151608083015160405185907fe6aa55a5f0d0d79d1f57832e265b9f8f8e44714636f732a4a7abc134a2fd360e90600090a45b505050565b600054600160a060020a031633146109d35760405160008051602061278083398151915281526004016104f4906125b9565b6002546040517fa6f9dae1000000000000000000000000000000000000000000000000000000008152600160a060020a039091169063a6f9dae190610a1c90849060040161242c565b600060405180830381600087803b158015610a3657600080fd5b505af1158015610a4a573d6000803e3d6000fd5b5050505050565b610a596116ec565b6002546040517f51ec4656000000000000000000000000000000000000000000000000000000008152600160a060020a03909116906351ec465690610aa290859060040161260a565b60006040518083038186803b158015610aba57600080fd5b505afa158015610ace573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f19168201604052610af69190810190611e47565b60025460808201516040517f1ac2733c0000000000000000000000000000000000000000000000000000000081529293503392600160a060020a0390921691631ac2733c91610b479160040161260a565b60006040518083038186803b158015610b5f57600080fd5b505afa158015610b73573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f19168201604052610b9b9190810190611e7c565b60400151600160a060020a031614610bcd5760405160008051602061278083398151915281526004016104f490612599565b6002546040517fb5d006f3000000000000000000000000000000000000000000000000000000008152600160a060020a039091169063b5d006f390610c1690859060040161260a565b602060405180830381600087803b158015610c3057600080fd5b505af1158015610c44573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250610c689190810190611d23565b15610ca35760a0810151608082015160405184907fe6aa55a5f0d0d79d1f57832e265b9f8f8e44714636f732a4a7abc134a2fd360e90600090a45b5050565b600254604080517f03cb53ec0000000000000000000000000000000000000000000000000000000081529051600092600160a060020a0316916303cb53ec916004808301926020929190829003018186803b158015610d0557600080fd5b505afa158015610d19573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250610d3d9190810190611f04565b905090565b600154600160a060020a031681565b600254600160a060020a031681565b6060806060806000806000806060610d766116ec565b6002546040517f51ec4656000000000000000000000000000000000000000000000000000000008152600160a060020a03909116906351ec465690610dbf908e9060040161260a565b60006040518083038186803b158015610dd757600080fd5b505afa158015610deb573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f19168201604052610e139190810190611e47565b905080600001519950806020015198508060400151975080606001519650806080015195508060a0015194508060c0015193508060e0015192508061010001519150509193959799909294969850565b610e6b6116ec565b6002546040517f51ec4656000000000000000000000000000000000000000000000000000000008152600160a060020a03909116906351ec465690610eb490899060040161260a565b60006040518083038186803b158015610ecc57600080fd5b505afa158015610ee0573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f19168201604052610f089190810190611e47565b90508060c001511515610f355760405160008051602061278083398151915281526004016104f4906125c9565b8060e001511515610f605760405160008051602061278083398151915281526004016104f490612569565b6101008101516000805b8251811015610fad5782513390849083908110610f8357fe5b90602001906020020151600160a060020a03161415610fa55760019150610fad565b600101610f6a565b50801515610fd55760405160008051602061278083398151915281526004016104f4906125a9565b6002546040517f1ebb242f000000000000000000000000000000000000000000000000000000008152600160a060020a0390911690631ebb242f90611026908b908b908b908b908b90600401612638565b600060405180830381600087803b15801561104057600080fd5b505af1158015611054573d6000803e3d6000fd5b505050505050505050505050565b600354600160a060020a031681565b600054600160a060020a031681565b600054600160a060020a031633146110b25760405160008051602061278083398151915281526004016104f4906125b9565b600160a060020a03811615156110e25760405160008051602061278083398151915281526004016104f490612579565b6000805473ffffffffffffffffffffffffffffffffffffffff1916600160a060020a0383161790556040517f95fd54179c11867fb083dd94347ea50f144dd4cfd7612b7bca169f162824af169061113a90839061242c565b60405180910390a150565b600080600160009054906101000a9004600160a060020a0316600160a060020a0316635c7460d66040518163ffffffff1660e060020a02815260040160206040518083038186803b15801561119957600080fd5b505afa1580156111ad573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052506111d19190810190611b92565b600160a060020a031663265209f2846040518263ffffffff1660e060020a0281526004016111ff919061242c565b60206040518083038186803b15801561121757600080fd5b505afa15801561122b573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525061124f9190810190611f04565b9050600084600581111561125f57fe5b60020a9190911615159150505b92915050565b61127a6116ec565b6002546040517f51ec4656000000000000000000000000000000000000000000000000000000008152600160a060020a03909116906351ec4656906112c390859060040161260a565b60006040518083038186803b1580156112db57600080fd5b505afa1580156112ef573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f1916820160405261126c9190810190611e47565b600054600160a060020a031633146113495760405160008051602061278083398151915281526004016104f4906125b9565b600254600160a060020a03161561137a5760405160008051602061278083398151915281526004016104f4906125d9565b506002805473ffffffffffffffffffffffffffffffffffffffff1916600160a060020a0392909216919091179055565b6113b26116ec565b6002546040517f51ec4656000000000000000000000000000000000000000000000000000000008152600160a060020a03909116906351ec4656906113fb90859060040161260a565b60006040518083038186803b15801561141357600080fd5b505afa158015611427573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f1916820160405261144f9190810190611e47565b610100810151519091501561146057fe5b6114686116ca565b60025460a08301516040517ff77ee79d000000000000000000000000000000000000000000000000000000008152600160a060020a039092169163f77ee79d916114b49160040161260a565b60006040518083038186803b1580156114cc57600080fd5b505afa1580156114e0573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f191682016040526115089190810190611eb1565b90506060600360009054906101000a9004600160a060020a0316600160a060020a03166324a793c46040518163ffffffff1660e060020a02815260040160206040518083038186803b15801561155d57600080fd5b505afa158015611571573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052506115959190810190611b92565b600160a060020a031663ade1e99283604001516040518263ffffffff1660e060020a0281526004016115c7919061260a565b60006040518083038186803b1580156115df57600080fd5b505afa1580156115f3573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f1916820160405261161b9190810190611bea565b50506002546040517f43f3f19a000000000000000000000000000000000000000000000000000000008152939950600160a060020a031697506343f3f19a965061167395508b94508893505060049091019050612618565b600060405180830381600087803b15801561168d57600080fd5b505af11580156116a1573d6000803e3d6000fd5b5050505050505050565b6040805160608181018352808252602082015260009181019190915290565b6060604051908101604052806060815260200160608152602001600081525090565b61012060405190810160405280606081526020016060815260200160608152602001606081526020016000815260200160008152602001600015158152602001600015158152602001606081525090565b600061174982356126fc565b9392505050565b600061174982516126fc565b6000601f8201831361176d57600080fd5b815161178061177b826126a0565b612679565b915081818352602084019350602081019050838560208402820111156117a557600080fd5b60005b838110156117d157816117bb8882611750565b84525060209283019291909101906001016117a8565b5050505092915050565b6000601f820183136117ec57600080fd5b81516117fa61177b826126a0565b9150818183526020840193506020810190508385602084028201111561181f57600080fd5b60005b838110156117d157816118358882611750565b8452506020928301929190910190600101611822565b60006117498251612707565b6000611749823561271b565b600080601f8301841361187557600080fd5b50813567ffffffffffffffff81111561188d57600080fd5b6020830191508360018202830111156118a557600080fd5b9250929050565b6000601f820183136118bd57600080fd5b81516118cb61177b826126c1565b915080825260208301602083018583830111156118e757600080fd5b6118f2838284612745565b50505092915050565b6000610120828403121561190e57600080fd5b611919610120612679565b825190915067ffffffffffffffff81111561193357600080fd5b61193f848285016118ac565b825250602082015167ffffffffffffffff81111561195c57600080fd5b611968848285016118ac565b602083015250604082015167ffffffffffffffff81111561198857600080fd5b611994848285016118ac565b604083015250606082015167ffffffffffffffff8111156119b457600080fd5b6119c0848285016118ac565b60608301525060806119d484828501611b60565b60808301525060a06119e884828501611b60565b60a08301525060c06119fc8482850161184b565b60c08301525060e0611a108482850161184b565b60e08301525061010082015167ffffffffffffffff811115611a3157600080fd5b611a3d8482850161175c565b6101008301525092915050565b600060608284031215611a5c57600080fd5b611a666060612679565b825190915067ffffffffffffffff811115611a8057600080fd5b611a8c848285016118ac565b825250602082015167ffffffffffffffff811115611aa957600080fd5b611ab5848285016118ac565b6020830152506040611ac984828501611750565b60408301525092915050565b600060608284031215611ae757600080fd5b611af16060612679565b825190915067ffffffffffffffff811115611b0b57600080fd5b611b17848285016118ac565b825250602082015167ffffffffffffffff811115611b3457600080fd5b611b40848285016118ac565b6020830152506040611ac984828501611b60565b60006117498235612718565b60006117498251612718565b600060208284031215611b7e57600080fd5b6000611b8a848461173d565b949350505050565b600060208284031215611ba457600080fd5b6000611b8a8484611750565b60008060408385031215611bc357600080fd5b6000611bcf858561173d565b9250506020611be08582860161173d565b9150509250929050565b6000806000806000806000806000806101408b8d031215611c0a57600080fd5b6000611c168d8d611750565b9a50506020611c278d828e01611750565b9950506040611c388d828e01611b60565b9850506060611c498d828e0161184b565b97505060808b015167ffffffffffffffff811115611c6657600080fd5b611c728d828e016118ac565b96505060a08b015167ffffffffffffffff811115611c8f57600080fd5b611c9b8d828e016117db565b95505060c08b015167ffffffffffffffff811115611cb857600080fd5b611cc48d828e016118ac565b94505060e08b015167ffffffffffffffff811115611ce157600080fd5b611ced8d828e016118ac565b935050610100611cff8d828e01611750565b925050610120611d118d828e0161184b565b9150509295989b9194979a5092959850565b600060208284031215611d3557600080fd5b6000611b8a848461184b565b60008060408385031215611d5457600080fd5b6000611bcf8585611857565b60008060008060008060008060008060c08b8d031215611d7f57600080fd5b8a3567ffffffffffffffff811115611d9657600080fd5b611da28d828e01611863565b9a509a505060208b013567ffffffffffffffff811115611dc157600080fd5b611dcd8d828e01611863565b985098505060408b013567ffffffffffffffff811115611dec57600080fd5b611df88d828e01611863565b965096505060608b013567ffffffffffffffff811115611e1757600080fd5b611e238d828e01611863565b94509450506080611e368d828e01611b54565b92505060a0611d118d828e01611b54565b600060208284031215611e5957600080fd5b815167ffffffffffffffff811115611e7057600080fd5b611b8a848285016118fb565b600060208284031215611e8e57600080fd5b815167ffffffffffffffff811115611ea557600080fd5b611b8a84828501611a4a565b600060208284031215611ec357600080fd5b815167ffffffffffffffff811115611eda57600080fd5b611b8a84828501611ad5565b600060208284031215611ef857600080fd5b6000611b8a8484611b54565b600060208284031215611f1657600080fd5b6000611b8a8484611b60565b600080600080600060608688031215611f3a57600080fd5b6000611f468888611b54565b955050602086013567ffffffffffffffff811115611f6357600080fd5b611f6f88828901611863565b9450945050604086013567ffffffffffffffff811115611f8e57600080fd5b611f9a88828901611863565b92509250509295509295909350565b6000611fb58383611fbd565b505060200190565b611fc6816126fc565b82525050565b6000611fd7826126ef565b611fe181856126f3565b9350611fec836126e9565b60005b8281101561201757612002868351611fa9565b955061200d826126e9565b9150600101611fef565b5093949350505050565b600061202c826126ef565b61203681856126f3565b9350612041836126e9565b60005b8281101561201757612057868351611fa9565b9550612062826126e9565b9150600101612044565b611fc681612707565b611fc68161272e565b600061208a83856126f3565b9350612097838584612739565b6120a083612775565b9093019392505050565b60006120b5826126ef565b6120bf81856126f3565b93506120cf818560208601612745565b6120a081612775565b60006120e5601f836126f3565b7f64656d616e64206f776e657220686173206e6f74206167726565642079657400815260200192915050565b600061211e6018836126f3565b7f307830206173206f776e6572206e6f7420616c6c6f7765640000000000000000815260200192915050565b60006121576027836126f3565b7f63726561746544656d616e643a2077726f6e67206f776e6572207768656e206381527f72656174696e6700000000000000000000000000000000000000000000000000602082015260400192915050565b60006121b66028836126f3565b7f617070726f766541677265656d656e7444656d616e643a2077726f6e67206d7381527f672e73656e646572000000000000000000000000000000000000000000000000602082015260400192915050565b6000612215601e836126f3565b7f73656e646572206973206e6f7420696e206d6174636865722061727261790000815260200192915050565b600061224e6017836126f3565b7f6d73672e73656e646572206973206e6f74206f776e6572000000000000000000815260200192915050565b6000612287601f836126f3565b7f737570706c79206f776e657220686173206e6f74206167726565642079657400815260200192915050565b60006122c06018836126f3565b7f696e69743a20616c726561647920696e697469616c697a650000000000000000815260200192915050565b60006122f96028836126f3565b7f617070726f766541677265656d656e74537570706c793a2077726f6e67206d7381527f672e73656e646572000000000000000000000000000000000000000000000000602082015260400192915050565b80516101208084526000919084019061236482826120aa565b9150506020830151848203602086015261237e82826120aa565b9150506040830151848203604086015261239882826120aa565b915050606083015184820360608601526123b282826120aa565b91505060808301516123c76080860182612423565b5060a08301516123da60a0860182612423565b5060c08301516123ed60c086018261206c565b5060e083015161240060e086018261206c565b5061010083015184820361010086015261241a8282612021565b95945050505050565b611fc681612718565b6020810161126c8284611fbd565b6020810161126c828461206c565b6020810161126c8284612075565b60c08082528101612468818c8e61207e565b9050818103602083015261247d818a8c61207e565b9050818103604083015261249281888a61207e565b905081810360608301526124a781868861207e565b90506124b66080830185612423565b6124c360a0830184612423565b9b9a5050505050505050505050565b61012080825281016124e4818c6120aa565b905081810360208301526124f8818b6120aa565b9050818103604083015261250c818a6120aa565b9050818103606083015261252081896120aa565b905061252f6080830188612423565b61253c60a0830187612423565b61254960c083018661206c565b61255660e083018561206c565b8181036101008301526124c38184611fcc565b6020808252810161126c816120d8565b6020808252810161126c81612111565b6020808252810161126c8161214a565b6020808252810161126c816121a9565b6020808252810161126c81612208565b6020808252810161126c81612241565b6020808252810161126c8161227a565b6020808252810161126c816122b3565b6020808252810161126c816122ec565b60208082528101611749818461234b565b6020810161126c8284612423565b604081016126268285612423565b8181036020830152611b8a8184611fcc565b606081016126468288612423565b818103602083015261265981868861207e565b9050818103604083015261266e81848661207e565b979650505050505050565b60405181810167ffffffffffffffff8111828210171561269857600080fd5b604052919050565b600067ffffffffffffffff8211156126b757600080fd5b5060209081020190565b600067ffffffffffffffff8211156126d857600080fd5b506020601f91909101601f19160190565b60200190565b5190565b90815260200190565b600061126c8261270c565b151590565b600160a060020a031690565b90565b60006006821061272a57600080fd5b5090565b600061126c826126fc565b82818337506000910152565b60005b83811015612760578181015183820152602001612748565b8381111561276f576000848401525b50505050565b601f01601f19169056fe08c379a000000000000000000000000000000000000000000000000000000000a265627a7a723058209cfaa33af6e0586ae31a9d85299d9b2351783f9e77708aee8bd854083c4bee886c6578706572696d656e74616cf50037","source":"// Copyright 2018 Energy Web Foundation\n// This file is part of the Origin Application brought to you by the Energy Web Foundation,\n// a global non-profit organization focused on accelerating blockchain technology across the energy sector,\n// incorporated in Zug, Switzerland.\n//\n// The Origin Application is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n// This is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY and without an implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details, at <http://www.gnu.org/licenses/>.\n//\n// @authors: slock.it GmbH; Martin Kuechler, martin.kuchler@slock.it; Heiko Burkhardt, heiko.burkhardt@slock.it\n\npragma solidity ^0.5.2;\npragma experimental ABIEncoderV2;\n\nimport \"../../contracts/Trading/MarketDB.sol\";\nimport \"ew-user-registry-contracts/contracts/Users/RoleManagement.sol\";\nimport \"ew-utils-general-contracts/contracts/Interfaces/Updatable.sol\";\nimport \"ew-asset-registry-contracts/contracts/Interfaces/AssetGeneralInterface.sol\";\nimport \"ew-asset-registry-contracts/contracts/Interfaces/AssetProducingInterface.sol\";\nimport \"ew-asset-registry-contracts/contracts/Interfaces/AssetConsumingInterface.sol\";\nimport \"ew-asset-registry-contracts/contracts/Interfaces/AssetContractLookupInterface.sol\";\nimport \"../../contracts/Interfaces/MarketContractLookupInterface.sol\";\n\ncontract AgreementLogic is RoleManagement, Updatable {\n\n    event LogAgreementFullySigned(uint indexed _agreementId, uint indexed _demandId, uint indexed _supplyId);\n    event LogAgreementCreated(uint indexed _agreementId, uint indexed _demandId, uint indexed _supplyId);\n\n    /// @notice database contract\n    MarketDB public db;\n\n    AssetContractLookupInterface public assetContractLookup;\n\n    /// @notice constructor\n    constructor(\n        AssetContractLookupInterface _assetContractLookup,\n        MarketContractLookupInterface _marketContractLookup\n    )\n        RoleManagement(UserContractLookupInterface(_assetContractLookup.userRegistry()), address(_marketContractLookup))\n        public\n    {\n        assetContractLookup = _assetContractLookup;\n    }\n\n\t/// @notice Function to create a agreement\n\t/// @dev will return an event with the event-Id\n\t/// @param _propertiesDocumentHash document-hash with all the properties of the demand\n\t/// @param _documentDBURL url-address of the demand\n\t/// @param _demandId the demand Id\n\t/// @param _supplyId the supply Id\n    function createAgreement(\n        string calldata _propertiesDocumentHash,\n        string calldata _documentDBURL,\n        string calldata _matcherPropertiesDocumentHash,\n        string calldata _matcherDBURL,\n        uint _demandId,\n        uint _supplyId\n    )\n        external\n    {\n        MarketDB.Demand memory demand = db.getDemand(_demandId);\n        MarketDB.Supply memory supply = db.getSupply(_supplyId);\n\n        address supplyOwner = AssetGeneralInterface(assetContractLookup.assetProducingRegistry()).getAssetOwner(supply.assetId);\n\n        require(msg.sender == demand.demandOwner || msg.sender == supplyOwner, \"createDemand: wrong owner when creating\");\n        uint agreementId = db.createAgreementDB(\n            _propertiesDocumentHash, \n            _documentDBURL,\n            _matcherPropertiesDocumentHash,\n            _matcherDBURL,\n            _demandId, \n            _supplyId\n        );\n\n        setAgreementMatcher(agreementId);\n\n        if(msg.sender == demand.demandOwner){\n            approveAgreementDemand(agreementId);\n        }\n        if(msg.sender == supplyOwner){\n            approveAgreementSupply(agreementId);\n        }\n\n        emit LogAgreementCreated(agreementId, _demandId, _supplyId);\n    }\n\n\t/// @notice fuction to set the database contract, can only be called once\n\t/// @param _database the database contract\n\t/// @param _admin the admin\n    function init(address _database, address _admin)\n        public\n        onlyOwner\n    {\n        require(address(db) == address(0x0),\"init: already initialize\");\n        db = MarketDB(_database);\n    }\n\n\t/// @notice Updates the logic contract\n\t/// @param _newLogic Address of the new logic contract\n    function update(address _newLogic)\n        external\n        onlyOwner\n    {\n        db.changeOwner(_newLogic);\n    }\n\n\t/// @notice get all agreement list length\n\t/// @return length of the allAgreements-array\n    function getAllAgreementListLength() external view returns (uint) {\n        return db.getAllAgreementListLengthDB();\n    }\n\n\t/// @notice gets agreement\n\t/// @param _agreementId the agreement Id\n\t/// @return the agreement\n    function getAgreement(uint _agreementId)\n        external\n        view\n        returns (\n            string memory _propertiesDocumentHash,\n            string memory _documentDBURL,\n            string memory _matcherPropertiesDocumentHash,\n            string memory _matcherDBURL,\n            uint _demandId,\n            uint _supplyId,\n            bool _approvedBySupplyOwner,\n            bool _approvedByDemandOwner,\n            address[] memory _allowedMatcher\n        )\n    {\n        MarketDB.Agreement memory agreement = db.getAgreementDB(_agreementId);\n        _propertiesDocumentHash = agreement.propertiesDocumentHash;\n        _documentDBURL = agreement.documentDBURL;\n        _matcherPropertiesDocumentHash = agreement.matcherPropertiesDocumentHash;\n        _matcherDBURL = agreement.matcherDBURL;\n        _demandId = agreement.demandId;\n        _supplyId = agreement.supplyId;\n        _approvedBySupplyOwner = agreement.approvedBySupplyOwner;\n        _approvedByDemandOwner = agreement.approvedByDemandOwner;\n        _allowedMatcher = agreement.allowedMatcher;\n    }\n\n    function getAgreementStruct(uint _agreementId)\n        external\n        view\n        returns (MarketDB.Agreement memory){\n            return db.getAgreementDB(_agreementId);\n        }\n\n\t/// @notice approves a demand for an agreement\n\t/// @param _agreementId the agreement Id\n    function approveAgreementDemand(uint _agreementId)\n        public\n    {\n        MarketDB.Agreement memory agreement = db.getAgreementDB(_agreementId);\n        require(db.getDemand(agreement.demandId).demandOwner == msg.sender, \"approveAgreementDemand: wrong msg.sender\");\n\n        // we approve a demand. If it's returning true it means that both supply and demand are approved thus making the agreement complete\n        if(db.approveAgreementDemandDB(_agreementId)) {\n            emit LogAgreementFullySigned(_agreementId, agreement.demandId, agreement.supplyId);\n        }\n    }\n\n\t/// @notice approves a supply for an agreement\n\t/// @param _agreementId the agreement Id\n    function approveAgreementSupply(uint _agreementId)\n        public\n    {\n        MarketDB.Agreement memory agreement = db.getAgreementDB(_agreementId);\n        MarketDB.Supply memory supply = db.getSupply(agreement.supplyId);\n\n        require(AssetGeneralInterface(assetContractLookup.assetProducingRegistry()).getAssetOwner(supply.assetId) == msg.sender, \"approveAgreementSupply: wrong msg.sender\");\n\n        // we approve a supply. If it's returning true it means that both supply and demand are approved thus making the agreement complete\n        if(db.approveAgreementSupplyDB(_agreementId)){\n            emit LogAgreementFullySigned(_agreementId, agreement.demandId, agreement.supplyId);\n        }\n    }\n\n    /// @notice sets the matcher for an agreement\n    /// @dev can only be called as long as there are no matchers set\n    /// @param _agreementId the agreement-Id\n    function setAgreementMatcher(uint _agreementId) \n        internal \n    {\n        MarketDB.Agreement memory agreement = db.getAgreementDB(_agreementId);\n\n        assert(agreement.allowedMatcher.length == 0);\n        MarketDB.Supply memory supply = db.getSupply(agreement.supplyId);\n\n        (,,,,,address[] memory matcherArray,,,,) = AssetGeneralInterface(assetContractLookup.assetProducingRegistry()).getAssetGeneral(supply.assetId);\n\n        db.setAgreementMatcher( _agreementId, matcherArray);\n    }\n\n    /// @notice allows matcher to change the matcher-properties for an agreement\n    /// @param _agreementId the agreement-ID\n    /// @param _matcherPropertiesDocumentHash document-hash of the matcher properties\n    /// @param _matcherDBURL db-url of the document-hash\n    function setMatcherProperties(\n        uint _agreementId,\n        string calldata _matcherPropertiesDocumentHash,\n        string calldata _matcherDBURL\n    )\n        external\n    {\n        MarketDB.Agreement memory agreement = db.getAgreementDB(_agreementId);\n\n        require(agreement.approvedBySupplyOwner, \"supply owner has not agreed yet\");\n        require(agreement.approvedByDemandOwner, \"demand owner has not agreed yet\");\n        address[] memory agreementMatcher = agreement.allowedMatcher;\n        \n        bool foundMatcher = false;\n\n        // we have to check all the matchers\n        for(uint i=0; i < agreementMatcher.length; i++){\n\n            if ( agreementMatcher[i] == msg.sender) {\n                foundMatcher = true;\n                break;\n            }\n        }\n\n        require(foundMatcher, \"sender is not in matcher array\");\n\n        db.setMatcherPropertiesAndURL(_agreementId, _matcherPropertiesDocumentHash, _matcherDBURL);\n    \n    }\n}","networks":"{}"}